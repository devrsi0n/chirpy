query allProjects {
  projects {
    id
  }
}

query themeProjectByPk($id: uuid!) {
  projectByPk(id: $id) {
    id
    name
    theme
  }
}

query projectByPk($id: uuid!) {
  projectByPk(id: $id) {
    id
  }
}

query projectsOfDashboard(
  $username: String!
  $today: timestamptz!
  $yesterday: timestamptz!
  $twoDaysAgo: timestamptz!
) {
  projects(where: { user: { username: { _eq: $username } } }) {
    id
    name
    createdAt
    pages {
      id
      title
      url
    }
    sessionsYesterday: sessions {
      events_aggregate(
        where: { type: { _eq: "pageview" }, created_at: { _gte: $yesterday, _lt: $today } }
      ) {
        aggregate {
          count(columns: id)
        }
        nodes {
          created_at
        }
      }
    }
    sessionsTwoDaysAgo: sessions {
      events_aggregate(
        where: { type: { _eq: "pageview" }, created_at: { _gte: $twoDaysAgo, _lt: $yesterday } }
      ) {
        aggregate {
          count(columns: id)
        }
        nodes {
          created_at
        }
      }
    }
  }
}

query projectAnalytics(
  $projectId: uuid!
  $today: timestamptz!
  $yesterday: timestamptz!
  $twoDaysAgo: timestamptz!
) {
  projectByPk(id: $projectId) {
    id
    name
    domain
    sessionsYesterday: sessions {
      events(where: { type: { _eq: "pageview" }, created_at: { _gte: $yesterday, _lt: $today } }) {
        created_at
      }
    }
    sessionsTwoDaysAgo: sessions {
      events(
        where: { type: { _eq: "pageview" }, created_at: { _gte: $twoDaysAgo, _lt: $yesterday } }
      ) {
        created_at
      }
    }
  }
}
