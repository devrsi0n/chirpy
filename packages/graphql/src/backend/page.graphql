# TODO: Merge with `pageByUrlOnly`
query pageByURL($url: String!, $projectId: uuid!) {
  pages(
    limit: 1
    where: { url: { _eq: $url }, projectId: { _eq: $projectId } }
  ) {
    id
    url
    title
    project {
      domain
    }
  }
}

mutation insertOnePage($projectId: uuid!, $title: String!, $url: String!) {
  insertOnePage(object: { projectId: $projectId, title: $title, url: $url }) {
    id
    url
    title
    project {
      domain
    }
  }
}

mutation updatePages($projectId: uuid!, $title: String!, $url: String!) {
  updatePages(
    where: { url: { _eq: $url }, projectId: { _eq: $projectId } }
    # Make sure all fields are filled if we add more fields here
    _set: { title: $title }
  ) {
    returning {
      id
    }
    affected_rows
  }
}

# Used in pages/widget/comment/[pageURL].tsx
query freshPages($limit: Int!) {
  pages(order_by: { createdAt: desc }, limit: $limit) {
    id
    url
    createdAt
  }
}

query pageByUrlOnly($url: String!) {
  pages(limit: 1, where: { url: { _eq: $url } }) {
    id
    url
  }
}

query themeOfPage($pageId: uuid!) {
  pageByPk(id: $pageId) {
    id
    url
    project {
      id
      theme
    }
  }
}
