# Migration `20201125142418-add-like-model`

This migration has been generated by Devrsi0n at 11/25/2020, 10:24:18 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "Like" (
    "id" TEXT NOT NULL,
    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updatedAt" TIMESTAMP(3) NOT NULL,
    "userId" TEXT NOT NULL,
    "commentId" TEXT NOT NULL,

    PRIMARY KEY ("id")
)

ALTER TABLE "Like" ADD FOREIGN KEY("userId")REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "Like" ADD FOREIGN KEY("commentId")REFERENCES "Comment"("id") ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20201122065126-init..20201125142418-add-like-model
--- datamodel.dml
+++ datamodel.dml
@@ -2,9 +2,9 @@
 // learn more about it in the docs: https://pris.ly/d/prisma-schema
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider        = "prisma-client-js"
@@ -47,10 +47,10 @@
   members   Member[]
   project   Project[]
 }
-// A project is associated with a `FREE` user or a Team(create by `PRO` user)
-// A project has multiple pages
+/// A project is associated with a `FREE` user or a Team(create by `PRO` user)
+/// A project has multiple pages
 model Project {
   id        String   @id @default(cuid())
   createdAt DateTime @default(now())
   updatedAt DateTime @updatedAt
@@ -62,18 +62,18 @@
   userId    String?
   pages     Page[]
 }
-// A page has multiple comments
+/// A page has multiple comments
 model Page {
   id        String    @id @default(cuid())
   createdAt DateTime  @default(now())
   updatedAt DateTime  @updatedAt
   // Embedded page's url, should not include query parameter. e.g. /post?id=123
   url       String
   title     String
   comments  Comment[]
-  project   Project   @relation(fields: [projectId], references: [id])
+  projects   Project   @relation(fields: [projectId], references: [id])
   projectId String
 }
 model Comment {
@@ -82,8 +82,9 @@
   updatedAt DateTime @updatedAt
   user    User   @relation(fields: [userId], references: [id])
   userId  String
+
   // User input: Slate.js data
   content Json
   page   Page   @relation(fields: [pageId], references: [id])
@@ -91,10 +92,25 @@
   replies   Comment[] @relation("RepliesToComment")
   comment   Comment?  @relation("RepliesToComment", fields: [commentId], references: [id])
   commentId String?
+
+  // One comment has multiply likes, one like made by one user and link to one comment
+  likes Like[]
 }
+model Like {
+  id        String   @id @default(cuid())
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+
+  user    User   @relation(fields: [userId], references: [id])
+  userId  String
+
+  comment    Comment   @relation(fields: [commentId], references: [id])
+  commentId  String
+}
+
 enum Role {
   USER
   ADMIN
 }
```
